```{r}
library(tidyverse)
library(janitor)
library(naniar)
library(shiny)
library(shinydashboard)
```
# Import Data
```{r}
spacemission_fixed <- read_csv("data/space_missions_fixed.csv") %>% 
  clean_names() %>%
  separate(location, into = c("site1", "site2", "site3", "site4", "area", "country"), extra = "drop", fill = "left", sep = ",") %>%
  select(-site1, -site2, -site3, -site4) %>%
  separate(date, into = c("year", "month", "date"), sep = "-")
```

```{r}
names(spacemission_fixed)
```


# Graph Outline

```{r}
spacemission_fixed %>%
  ggplot(aes(x = year, y = mission_status, fill = mission_status))+
  geom_col()+
  coord_flip()
```

```{r}
spacemission_test <- spacemission_fixed %>%
  mutate()
```


# App
```{r}
ui <- dashboardPage(
  dashboardHeader(title = "Rocket Statistics from 1957-2018"),
  dashboardSidebar(disable = T),
  dashboardBody(
    fluidRow(
      box(title = "Plot (RENAME PENDING)", width = 12,
          radioButtons("x", "Select Fill", choices = c("mission_status", "rocket_status", "country"),
                       selected = "mission_status"),
          plotOutput("plot1")
      )),#closes first box
      fluidRow(title = "Rocket Pictures", width = 5,
          selectInput("image_select", "Select Image", choices = c("Cosmos-3M (11K65M)", "Voskhod","Falcon 9 Block 5","Cosmos-2I (63SM)", "Soyuz U")),
          imageOutput("image"), plotOutput("plot2")
      ),#closes fluid row
    )#closes dashboard body
  
) #closes dashboard page

server <- function(input, output, session) {
  output$image <- renderImage({
    list(src = paste0("images/", input$image_select, ".png"), contentType = "image/png", width = "300px")
  }, 
  deleteFile = FALSE) #closes render image
  output$plot1 <- renderPlot({
    spacemission_fixed %>%
      group_by(year) %>%
      ggplot(aes_string(x="year", fill = input$x))+
      geom_bar() + 
      theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
  }) #closes render plot
    output$plot2 <- renderPlot({
spacemission_fixed %>%
  select(rocket, year) %>%
  filter(rocket == input$image_select) %>%
  group_by(year) %>%
  mutate(year = as.numeric(year)) %>%
  count(year) %>%
  ggplot(aes(x = "year", y = "n"))+
  geom_col(fill = "purple")+
  labs(title = "Frequency a Selected Rocket was Launched Per Year",
       x = "Year",
       y = "Frequency")
  }) #closes render plot

  session$onSessionEnded(stopApp)
} #closes session

shinyApp(ui, server)
```


```{r}
spacemission_fixed %>%
  select(rocket) %>%
  group_by(rocket) %>%
  count(rocket) %>%
  arrange(desc(n))
```

```{r}
spacemission_fixed %>%
  select(rocket, year) %>%
  filter(rocket == "Voskhod") %>%
  group_by(year) %>%
  mutate(year = as.numeric(year)) %>%
  count(year) %>%
  ggplot(aes(x = year, y = n))+
  geom_col(fill = "purple")+
  labs(title = "Frequency a Selected Rocket was Launched Per Year",
       x = "Year",
       y = "Frequency")
```

